<div class="flex flex-col gap-6">
  <!-- HEADER -->
  <div
    class="flex flex-col md:flex-row md:items-center md:justify-between gap-3"
  >
    <h2 class="text-lg font-semibold">Kegiatan Kerjasama</h2>

    <div class="flex gap-2">
      <select
        id="filter-kegiatan"
        onchange="applyKegiatanFilter()"
        class="border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-purple-500"
      >
        <option value="">Semua Jenis</option>
        <option value="Pendidikan">Pendidikan</option>
        <option value="Penelitian">Penelitian</option>
        <option value="Pengabdian Kepada Masyarakat">
          Pengabdian Kepada Masyarakat
        </option>
      </select>

      <input
        type="text"
        id="search-kegiatan"
        onkeyup="applyKegiatanFilter()"
        placeholder="Cari kegiatan..."
        class="border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-purple-500"
      />

      <button
        onclick="openKegiatanForm()"
        class="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-purple-700"
      >
        + Tambah
      </button>
    </div>
  </div>

  <!-- TABLE -->
  <div class="bg-white rounded-xl shadow overflow-x-auto">
    <table class="w-full text-sm table-fixed">
      <thead class="bg-gray-100">
        <tr>
          <th class="p-3 text-left w-40">Unit Pelaksana</th>
          <th class="p-3 text-left w-24">Jenis</th>
          <th class="p-3 text-left w-40">Bentuk Kegiatan</th>
          <th class="p-3 text-left w-24">Tingkat</th>
          <th class="p-3 text-left w-32">Tanggal</th>
          <th class="p-3 text-left w-64">Judul Kerjasama</th>
          <th class="p-3 text-left w-40">Mitra</th>
          <th class="p-3 text-left w-32">Keterangan</th>

          <!-- AKSI -->
          <th
            class="p-3 text-center w-20 whitespace-nowrap sticky right-0 bg-gray-100 z-20"
          >
            Aksi
          </th>
        </tr>
      </thead>

      <tbody id="kegiatan-body"></tbody>
    </table>
  </div>
  <!-- MODAL KEGIATAN -->
  <!-- MODAL KEGIATAN -->
  <div
    id="kegiatan-modal"
    class="fixed inset-0 bg-black/40 hidden items-center justify-center z-50 px-4"
  >
    <div
      class="bg-white rounded-xl w-full max-w-5xl max-h-[90vh] flex flex-col"
    >
      <!-- HEADER -->
      <div class="px-6 py-4 border-b">
        <h3 class="font-semibold text-lg">Tambah Kegiatan Kerjasama</h3>
        <input type="hidden" id="kegiatanIndex" />
      </div>

      <!-- BODY (SCROLLABLE) -->
      <div class="px-6 py-4 overflow-y-auto flex-1">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
          <div class="md:col-span-2">
            <label class="block text-sm font-medium mb-1">
              Mitra Kerjasama
            </label>

            <div id="mitra-wrapper" class="relative w-full">
              <input
                id="k-no-search"
                type="text"
                placeholder="Cari Mitra..."
                class="w-full border px-3 py-2 rounded"
                onfocus="
                  kegiatanPopulateMitraDropdown();
                  kegiatanToggleMitraDropdown(true);
                "
                oninput="kegiatanFilterMitraDropdown()"
              />

              <input type="hidden" id="k-no" />

              <div
                id="k-no-dropdown"
                class="absolute left-0 right-0 mt-1 bg-white border rounded shadow-lg max-h-48 overflow-auto hidden z-50"
              ></div>
            </div>
          </div>

          <input type="hidden" id="k-no" />

          <div>
            <label for="k-mitra" class="block text-sm font-medium mb-1">
              Mitra
            </label>
            <input id="k-mitra" class="input w-full" />
          </div>

          <div>
            <label for="k-tanggal" class="block text-sm font-medium mb-1">
              Tanggal Kegiatan
            </label>
            <input type="date" id="k-tanggal" class="input w-full" />
          </div>

          <div>
            <label for="k-tingkat" class="block text-sm font-medium mb-1">
              Tingkat Kerjasama
            </label>
            <select id="k-tingkat" class="input w-full">
              <option value="">Pilih Tingkat</option>
              <option>International</option>
              <option>Nasional</option>
              <option>Lokal</option>
            </select>
          </div>

          <div>
            <label for="k-jenis-mitra" class="block text-sm font-medium mb-1">
              Jenis Mitra
            </label>
            <select id="k-jenis-mitra" class="input w-full">
              <option value="">Pilih Jenis Mitra</option>
              <option>Perguruan Tinggi</option>
              <option>Industri</option>
              <option>Pemerintah</option>
              <option>Lainnya</option>
            </select>
          </div>

          <div>
            <label for="k-jenis-dokumen" class="block text-sm font-medium mb-1">
              Jenis Dokumen
            </label>
            <select id="k-jenis-dokumen" class="input w-full">
              <option value="">Pilih Jenis Dokumen</option>
              <option>MoU (Memorandum of Understanding)</option>
              <option>MoA (Memorandum of Agreement)</option>
              <option>IA (Implementation Arrangement)</option>
            </select>
          </div>

          <div>
            <label for="k-bentuk" class="block text-sm font-medium mb-1">
              Bentuk Kegiatan
            </label>
            <select id="k-bentuk" class="input w-full">
              <option value="">Pilih Bentuk Kegiatan</option>
            </select>
          </div>

          <div>
            <label for="k-bidang" class="block text-sm font-medium mb-1">
              Bidang
            </label>
            <select id="k-bidang" class="input w-full">
              <option value="">Pilih Bidang</option>
              <option value="Pendidikan">Pendidikan</option>
              <option value="Penelitian">Penelitian</option>
              <option value="Pengabdian Kepada Masyarakat">
                Pengabdian Kepada Masyarakat
              </option>
            </select>
          </div>

          <div>
            <label for="k-pendanaan" class="block text-sm font-medium mb-1">
              Pendanaan
            </label>
            <select id="k-pendanaan" class="input w-full">
              <option value="">Pilih Pendanaan</option>
            </select>
          </div>

          <div>
            <label for="k-fakultas" class="block text-sm font-medium mb-1">
              Fakultas / Satker
            </label>
            <select id="k-fakultas" class="input w-full">
              <option value="">Pilih Fakultas / Satker</option>
            </select>
          </div>

          <div>
            <label for="k-pj" class="block text-sm font-medium mb-1">
              Penanggung Jawab (PJ)
            </label>
            <select id="k-pj" class="input w-full">
              <option value="">Pilih PJ</option>
            </select>
          </div>

          <div>
            <label for="k-tahun" class="block text-sm font-medium mb-1">
              Tahun
            </label>
            <input
              type="number"
              id="k-tahun"
              class="input w-full bg-gray-100"
              readonly
            />
          </div>

          <div id="admin-only-status">
            <label for="k-status" class="block text-sm font-medium mb-1">
              Status
            </label>
            <select id="k-status" class="input w-full">
              <option value="">Pilih Status</option>
              <option>Diterima</option>
              <option>Direvisi</option>
              <option>Belum Sesuai</option>
              <option>Proses</option>
            </select>
          </div>

          <div>
            <label for="k-cek-laporan" class="block text-sm font-medium mb-1">
              Cek Laporan
            </label>
            <select id="k-cek-laporan" class="input w-full">
              <option value="">Pilih Status</option>
              <option>Sudah</option>
              <option>Belum</option>
            </select>
          </div>
          <div>
            <label for="k-simkerma" class="block text-sm font-medium mb-1">
              Status SIMKERMA
            </label>
            <select id="k-simkerma" class="input" disabled>
              <option value="">SIMKERMA</option>
              <option value="Sudah">Sudah</option>
              <option value="Belum">Belum</option>
            </select>
          </div>

          <div id="admin-only-link" class="md:col-span-2">
            <label for="k-link-simkerma" class="block text-sm font-medium mb-1">
              Link SIMKERMA
            </label>
            <input id="k-link-simkerma" class="input w-full" />
          </div>

          <div class="md:col-span-2">
            <label for="k-laporan" class="block text-sm font-medium mb-1">
              Link Laporan Kegiatan
            </label>
            <input
              id="k-laporan"
              class="input w-full"
              placeholder="https://..."
            />
          </div>

          <div class="md:col-span-2">
            <label for="k-dokumen" class="block text-sm font-medium mb-1">
              Link Dokumen Kegiatan
            </label>
            <input
              id="k-dokumen"
              class="input w-full"
              placeholder="https://..."
            />
          </div>

          <div class="md:col-span-3">
            <label for="k-deskripsi" class="block text-sm font-medium mb-1">
              Deskripsi Kegiatan
            </label>
            <textarea id="k-deskripsi" class="input w-full" rows="3"></textarea>
          </div>

          <div id="admin-only-catatan" class="md:col-span-3">
            <label for="k-catatan" class="block text-sm font-medium mb-1">
              Catatan Admin
            </label>
            <textarea id="k-catatan" class="input w-full"></textarea>
          </div>
        </div>
      </div>

      <!-- FOOTER -->
      <div class="px-6 py-4 border-t flex justify-end gap-2">
        <button
          onclick="closeKegiatanForm()"
          class="px-4 py-2 border rounded-lg"
        >
          Batal
        </button>
        <button
          onclick="saveKegiatan()"
          class="px-4 py-2 bg-purple-600 text-white rounded-lg"
        >
          Simpan
        </button>
      </div>
    </div>
  </div>
  <div
    id="kegiatan-detail-modal"
    class="fixed inset-0 bg-black/40 hidden items-center justify-center z-50 px-4"
  >
    <div
      class="bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6"
    >
      <h3 class="font-semibold text-lg mb-4">Detail Kegiatan</h3>

      <div
        id="kegiatan-detail-content"
        class="grid grid-cols-2 gap-3 text-sm"
      ></div>

      <div class="flex justify-end gap-2 mt-6">
        <button
          onclick="closeKegiatanDetail()"
          class="border px-4 py-2 rounded"
        >
          Tutup
        </button>
        <button
          onclick="editFromDetail()"
          class="bg-purple-600 text-white px-4 py-2 rounded"
        >
          Edit
        </button>
      </div>
    </div>
  </div>

  <!-- PAGINATION -->
  <div class="flex justify-between items-center text-sm">
    <span id="kegiatan-info" class="text-gray-600"></span>
    <div id="kegiatan-pagination" class="flex gap-1"></div>
  </div>
</div>
